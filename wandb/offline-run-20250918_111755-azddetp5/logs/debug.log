2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Current SDK version is 0.19.1
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Configure stats pid to 988123
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from /home/zijun/.config/wandb/settings
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from /home/zijun/code/GroundFlow/wandb/settings
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:_log_setup():528] Logging user logs to /home/zijun/code/GroundFlow/wandb/offline-run-20250918_111755-azddetp5/logs/debug.log
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:_log_setup():529] Logging internal logs to /home/zijun/code/GroundFlow/wandb/offline-run-20250918_111755-azddetp5/logs/debug-internal.log
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:init():644] calling init triggers
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:init():650] wandb.init called with sweep_config: {}
config: {}
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:init():680] starting backend
2025-09-18 11:17:55,531 INFO    MainThread:988123 [wandb_init.py:init():684] sending inform_init request
2025-09-18 11:17:55,538 INFO    MainThread:988123 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-09-18 11:17:55,538 INFO    MainThread:988123 [wandb_init.py:init():697] backend started and connected
2025-09-18 11:17:55,539 INFO    MainThread:988123 [wandb_init.py:init():790] updated telemetry
2025-09-18 11:17:55,547 INFO    MainThread:988123 [wandb_init.py:init():822] communicating run to backend with 90.0 second timeout
2025-09-18 11:17:56,181 INFO    MainThread:988123 [wandb_init.py:init():874] starting run threads in backend
2025-09-18 11:17:56,319 INFO    MainThread:988123 [wandb_run.py:_console_start():2374] atexit reg
2025-09-18 11:17:56,319 INFO    MainThread:988123 [wandb_run.py:_redirect():2224] redirect: wrap_raw
2025-09-18 11:17:56,319 INFO    MainThread:988123 [wandb_run.py:_redirect():2289] Wrapping output streams.
2025-09-18 11:17:56,319 INFO    MainThread:988123 [wandb_run.py:_redirect():2314] Redirects installed.
2025-09-18 11:17:56,320 INFO    MainThread:988123 [wandb_init.py:init():916] run started, returning control to user process
2025-09-18 11:18:04,934 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Current SDK version is 0.19.1
2025-09-18 11:18:04,934 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Configure stats pid to 988123
2025-09-18 11:18:04,934 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from /home/zijun/.config/wandb/settings
2025-09-18 11:18:04,934 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from /home/zijun/code/GroundFlow/wandb/settings
2025-09-18 11:18:04,934 INFO    MainThread:988123 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-09-18 11:18:04,935 INFO    MainThread:988123 [wandb_init.py:_log_setup():528] Logging user logs to /home/zijun/code/GroundFlow/wandb/run-20250918_111804-326gsvnc/logs/debug.log
2025-09-18 11:18:04,935 INFO    MainThread:988123 [wandb_init.py:_log_setup():529] Logging internal logs to /home/zijun/code/GroundFlow/wandb/run-20250918_111804-326gsvnc/logs/debug-internal.log
2025-09-18 11:18:04,935 INFO    MainThread:988123 [wandb_init.py:init():644] calling init triggers
2025-09-18 11:18:04,935 INFO    MainThread:988123 [wandb_init.py:init():650] wandb.init called with sweep_config: {}
config: {}
2025-09-18 11:18:04,935 INFO    MainThread:988123 [wandb_init.py:init():675] wandb.init() called when a run is still active
2025-09-18 11:18:04,938 INFO    MainThread:988123 [wandb_run.py:_config_callback():1279] config_cb None None {'name': 'Sequential-Grounding', 'rng_seed': 42, 'num_gpu': 1, 'mode': 'train', 'note': '', 'base_dir': '', 'exp_dir': 'Sequential-Grounding/2025-09-18-11:18:04.032299', 'resume': False, 'debug': {'flag': False, 'hard_debug': False, 'debug_size': 4}, 'logger': {'name': 'wandb', 'entity': 'TBD', 'autoname': True, 'run_id': '326gsvnc'}, 'data': {'load_scan_options': {'load_inst_info': True, 'load_pc_info': True, 'load_segment_info': False, 'load_image_segment_feat': False, 'load_point_segment_feat': False, 'load_image_obj_feat': False, 'load_voxel_obj_feat': False}, 'process_num': 0, 'scene_verse_base': '/home/zijun/hdd1/sg3d/scene_verse_base', 'scene_verse_aux': '/home/zijun/hdd1/sg3d/scene_verse_aux', 'scene_verse_pred': '/home/zijun/hdd1/sg3d/scene_verse_pred', 'sequential_grounding_base': '/home/zijun/hdd1/sg3d/sequential_grounding_base', 'multi_step_context': True, 'drop_data_percent': 0.0, 'train': ['SequentialGrounding3RScan'], 'val': ['SequentialGrounding3RScan'], 'test': ['SequentialGrounding3RScan'], 'SequentialGroundingScanNet': {'pc_type': 'gt', 'evaluator': 'SequentialGroundingEval'}, 'SequentialGrounding3RScan': {'pc_type': 'gt', 'evaluator': 'SequentialGroundingEval'}, 'SequentialGroundingMultiScan': {'pc_type': 'gt', 'evaluator': 'SequentialGroundingEval'}, 'SequentialGroundingARKitScenes': {'pc_type': 'gt', 'evaluator': 'SequentialGroundingEval'}, 'SequentialGroundingHM3D': {'pc_type': 'gt', 'evaluator': 'SequentialGroundingEval'}}, 'task': 'SequentialGrounding', 'data_wrapper': {'train': 'SequentialGroundingDatasetWrapper', 'val': 'SequentialGroundingDatasetWrapper', 'test': 'SequentialGroundingDatasetWrapper'}, 'trainer': 'MultitaskTrainer', 'ckpt_path': '', 'pretrain_ckpt_path': '/home/zijun/hdd1/sg3d/sequential_grounding_base/LEO-1_align_lora', 'dataloader': {'batchsize': 4, 'num_workers': 1, 'balance_dataset': False, 'filter_empty_annotations': False}, 'solver': {'gradient_accumulation_steps': 5, 'lr': 0.0001, 'grad_norm': 5.0, 'optim': {'name': 'AdamW', 'args': {'lr': 0.0001, 'betas': [0.9, 0.999], 'weight_decay': 0.05}}, 'sched': {'name': 'warmup_cosine', 'args': {'warmup_steps': 400}}, 'epochs': 50, 'epochs_per_eval': 10, 'epochs_per_save': 0}, 'eval': {'save': False, 'predict_mode': False}, 'model': {'name': 'SequentialGrounder', 'notes': 'try', 'pre_grounding': True, 'llm': {'name': 'Vicuna7B', 'cfg_path': '/home/zijun/hdd1/sg3d/vicuna-7b', 'truncation_side': 'right', 'max_context_len': 256, 'max_out_len': 256, 'lora': {'flag': True, 'rank': 16, 'alpha': 16, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'gate_proj', 'up_proj', 'down_proj'], 'dropout': 0.0}}, 'vision2d': {'name': 'GridFeatureExtractor2D', 'backbone_name': 'convnext_base', 'backbone_pretrain_dataset': 'laion2b', 'use_pretrain': True, 'pooling': 'avg', 'freeze': True}, 'vision3d': {'name': 'OSE3D', 'hidden_dim': 256, 'use_spatial_attn': True, 'use_embodied_token': False, 'fourier_size': 84, 'lr': 0.0001, 'spatial_encoder': {'dim_loc': 6, 'num_attention_heads': 8, 'dim_feedforward': 2048, 'dropout': 0.1, 'activation': 'gelu', 'spatial_multihead': True, 'spatial_dim': 5, 'spatial_dist_norm': True, 'spatial_attn_fusion': 'cond', 'num_layers': 3, 'obj_loc_encoding': 'same_all', 'pairwise_rel_type': 'center'}, 'backbone': {'net': {'_target_': 'modules.layers.pointnet.PointNetPP', 'sa_n_points': [32, 16, None], 'sa_n_samples': [32, 32, None], 'sa_radii': [0.2, 0.4, None], 'sa_mlps': [[3, 64, 64, 128], [128, 128, 128, 256], [256, 256, 512, 768]]}, 'path': '/home/zijun/hdd1/sg3d/sequential_grounding_base/pointnet/pointnet.pth', 'freeze': True}}, 'clip_txt_guidance': {'flag': False, 'clip_out_dim': 1024}, 'ground_head': {'name': 'SequentialGroundHead', 'args': {'hidden_size': 4096, 'num_attention_heads': 32, 'num_layers': 2}, 'lr': 0.0001}, 'loss_list': ['LLMLoss', 'SequentialGroundLoss', 'obj_cls_post_loss'], 'vis_loss_list': [], 'loss_weights': {'SequentialGroundLoss': 1}}}
2025-09-18 11:19:11,107 WARNING MsgRouterThr:988123 [router.py:message_loop():75] message_loop has been closed
